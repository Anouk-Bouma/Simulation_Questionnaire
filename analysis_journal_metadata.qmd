---
title: "analysis_journal_metadata"
format: html
editor: visual
---

<!--# Hey bestie, before submitting the final version -> ctrl + f: 'NOTE' to check if all notes are evaluated and removed -->

## Version Control

```{r}
renv::restore()

library(tidyr)
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(purrr)
library(writexl)
library(openxlsx)
```

### Loading the data

Loading the files containing the metadata and inclusion decisions per article.

```{r}

###
# loading the data files
data_all_articles  <- read.xlsx(
  "all_articles_2023_2024_finaldecisions.xlsx", 
  sheet = "All")

data_included_articles <- read.xlsx(
  "all_articles_2023_2024_finaldecisions.xlsx",
  sheet = "Final mailinglist")
```

## Descriptives journal/inclusion data

```{r}

# Joining datasets to count the number of invited articles per journal
invited_counts <- data_included_articles %>%
  left_join(data_all_articles %>% select(DOI, Source.Title), by = "DOI") %>%
  filter(Bounce.Invitation == FALSE) %>%
  count(Source.Title, name = "invited")


# Table with descriptives about article inclusions per journal
summary_table <- data_all_articles %>%
  group_by(Source.Title) %>%
  summarise(
    total = n(),
    included = sum(included, na.rm = TRUE),
    percentage = round((included/total)*100, digits = 0)
  )

# Adding the invitations after bounce as a column to the table
summary_table$delivered_invitations <- invited_counts$invited

```

### Saving the data table

```{r}

# Save as Excel file
write.xlsx(summary_table, file = "sample_descriptives.xlsx")
```
